lr=0.1
epochs=50
sgd
数据增强

加载预训练
    # 加载官方ResNet18权重（仅加载非SE部分）
    pretrained_resnet18 = torchvision.models.resnet18(weights='IMAGENET1K_V1')
    model.load_state_dict(pretrained_resnet18.state_dict(), strict=False)



D:\ProgramData\anaconda3\envs\homework_2_1\python.exe D:/homework/Course_Design_of_artificial_intelligence/third/ResNet_Seblock/fangzhang_ResNet_kaggle_dalao/PhanDai_ResNet_seblock_kaggle_dalao/pre_test/newV1.py
Using device: cuda
数据增强：True | 训练：True | 测试：True

==== Epoch 1/50 ====
Train: 100%|██████████| 256/256 [02:43<00:00,  1.57it/s]
Val: 100%|██████████| 64/64 [00:25<00:00,  2.54it/s]
Train Loss: 4.5820 | Val Loss: 6.2627 | Val Acc: 0.0347 | Top-5: 0.1311 | F1: 0.0150

==== Epoch 2/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.64it/s]
Train Loss: 4.0038 | Val Loss: 4.1976 | Val Acc: 0.0778 | Top-5: 0.2440 | F1: 0.0524
Train:   0%|          | 0/256 [00:00<?, ?it/s]
==== Epoch 3/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.62it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 3.6469 | Val Loss: 4.9868 | Val Acc: 0.0533 | Top-5: 0.2337 | F1: 0.0266

==== Epoch 4/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:12<00:00,  5.23it/s]
Train Loss: 3.4217 | Val Loss: 3.8312 | Val Acc: 0.1174 | Top-5: 0.3878 | F1: 0.0888

==== Epoch 5/50 ====
Train: 100%|██████████| 256/256 [01:55<00:00,  2.21it/s]
Val: 100%|██████████| 64/64 [00:23<00:00,  2.72it/s]
Train Loss: 3.2054 | Val Loss: 3.6989 | Val Acc: 0.1452 | Top-5: 0.4244 | F1: 0.1279

==== Epoch 6/50 ====
Train: 100%|██████████| 256/256 [01:51<00:00,  2.29it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.60it/s]
Train Loss: 3.0107 | Val Loss: 3.5305 | Val Acc: 0.1638 | Top-5: 0.4279 | F1: 0.1144

==== Epoch 7/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.54it/s]
Train Loss: 2.9032 | Val Loss: 3.6585 | Val Acc: 0.1433 | Top-5: 0.3985 | F1: 0.1115

==== Epoch 8/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.49it/s]
Train Loss: 2.2320 | Val Loss: 2.3799 | Val Acc: 0.3663 | Top-5: 0.7159 | F1: 0.3403
Train:   0%|          | 0/256 [00:00<?, ?it/s]
==== Epoch 9/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.61it/s]
Train Loss: 1.9762 | Val Loss: 2.3142 | Val Acc: 0.3819 | Top-5: 0.7330 | F1: 0.3666

==== Epoch 10/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.78it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.59it/s]
Train Loss: 1.8334 | Val Loss: 2.2506 | Val Acc: 0.4093 | Top-5: 0.7447 | F1: 0.3897
Train:   0%|          | 0/256 [00:00<?, ?it/s]
==== Epoch 11/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.49it/s]
Train Loss: 1.7256 | Val Loss: 2.1960 | Val Acc: 0.4103 | Top-5: 0.7501 | F1: 0.3969

==== Epoch 12/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.65it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 1.6305 | Val Loss: 2.2659 | Val Acc: 0.3990 | Top-5: 0.7340 | F1: 0.3791

==== Epoch 13/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.62it/s]
Train Loss: 1.5446 | Val Loss: 2.1948 | Val Acc: 0.4108 | Top-5: 0.7531 | F1: 0.3959

==== Epoch 14/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.77it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 1.4476 | Val Loss: 2.2169 | Val Acc: 0.4176 | Top-5: 0.7584 | F1: 0.4013

==== Epoch 15/50 ====
Train: 100%|██████████| 256/256 [01:33<00:00,  2.74it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.52it/s]
Train Loss: 1.2190 | Val Loss: 2.0633 | Val Acc: 0.4553 | Top-5: 0.7800 | F1: 0.4459

==== Epoch 16/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.40it/s]
Train Loss: 1.1504 | Val Loss: 2.0645 | Val Acc: 0.4509 | Top-5: 0.7848 | F1: 0.4433

==== Epoch 17/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.38it/s]
Train Loss: 1.1114 | Val Loss: 2.0561 | Val Acc: 0.4587 | Top-5: 0.7804 | F1: 0.4475
Train:   0%|          | 0/256 [00:00<?, ?it/s]
==== Epoch 18/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.60it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 1.0936 | Val Loss: 2.0645 | Val Acc: 0.4557 | Top-5: 0.7785 | F1: 0.4428

==== Epoch 19/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.58it/s]
Train Loss: 1.0683 | Val Loss: 2.0292 | Val Acc: 0.4699 | Top-5: 0.7883 | F1: 0.4593
Train:   0%|          | 0/256 [00:00<?, ?it/s]
==== Epoch 20/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.61it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 1.0338 | Val Loss: 2.0505 | Val Acc: 0.4655 | Top-5: 0.7824 | F1: 0.4545

==== Epoch 21/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.69it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 1.0080 | Val Loss: 2.0537 | Val Acc: 0.4641 | Top-5: 0.7839 | F1: 0.4516

==== Epoch 22/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.68it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9669 | Val Loss: 2.0425 | Val Acc: 0.4660 | Top-5: 0.7848 | F1: 0.4557

==== Epoch 23/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.63it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9649 | Val Loss: 2.0392 | Val Acc: 0.4680 | Top-5: 0.7873 | F1: 0.4590

==== Epoch 24/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.56it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9653 | Val Loss: 2.0444 | Val Acc: 0.4763 | Top-5: 0.7868 | F1: 0.4658

==== Epoch 25/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.54it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9478 | Val Loss: 2.0456 | Val Acc: 0.4704 | Top-5: 0.7848 | F1: 0.4595

==== Epoch 26/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.72it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9535 | Val Loss: 2.0428 | Val Acc: 0.4704 | Top-5: 0.7853 | F1: 0.4601

==== Epoch 27/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.56it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9553 | Val Loss: 2.0485 | Val Acc: 0.4660 | Top-5: 0.7795 | F1: 0.4545

==== Epoch 28/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.47it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9540 | Val Loss: 2.0581 | Val Acc: 0.4743 | Top-5: 0.7839 | F1: 0.4627

==== Epoch 29/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.56it/s]
Train Loss: 0.9488 | Val Loss: 2.0381 | Val Acc: 0.4768 | Top-5: 0.7858 | F1: 0.4652

==== Epoch 30/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.77it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9428 | Val Loss: 2.0628 | Val Acc: 0.4699 | Top-5: 0.7824 | F1: 0.4588

==== Epoch 31/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.75it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9373 | Val Loss: 2.0422 | Val Acc: 0.4738 | Top-5: 0.7868 | F1: 0.4633

==== Epoch 32/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.39it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9302 | Val Loss: 2.0523 | Val Acc: 0.4689 | Top-5: 0.7858 | F1: 0.4589

==== Epoch 33/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.82it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.72it/s]
Train Loss: 0.9406 | Val Loss: 2.0454 | Val Acc: 0.4694 | Top-5: 0.7858 | F1: 0.4591

==== Epoch 34/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.76it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9383 | Val Loss: 2.0489 | Val Acc: 0.4689 | Top-5: 0.7819 | F1: 0.4588

==== Epoch 35/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.79it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.49it/s]
Train Loss: 0.9388 | Val Loss: 2.0353 | Val Acc: 0.4694 | Top-5: 0.7834 | F1: 0.4588

==== Epoch 36/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.80it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.61it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9422 | Val Loss: 2.0442 | Val Acc: 0.4670 | Top-5: 0.7809 | F1: 0.4564

==== Epoch 37/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.44it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9292 | Val Loss: 2.0371 | Val Acc: 0.4787 | Top-5: 0.7858 | F1: 0.4674

==== Epoch 38/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.64it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9446 | Val Loss: 2.0386 | Val Acc: 0.4689 | Top-5: 0.7858 | F1: 0.4588

==== Epoch 39/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.80it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.69it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9368 | Val Loss: 2.0439 | Val Acc: 0.4733 | Top-5: 0.7785 | F1: 0.4623

==== Epoch 40/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.65it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9309 | Val Loss: 2.0432 | Val Acc: 0.4724 | Top-5: 0.7839 | F1: 0.4625

==== Epoch 41/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.51it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9332 | Val Loss: 2.0467 | Val Acc: 0.4704 | Top-5: 0.7873 | F1: 0.4602

==== Epoch 42/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.64it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9338 | Val Loss: 2.0566 | Val Acc: 0.4748 | Top-5: 0.7907 | F1: 0.4657

==== Epoch 43/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.71it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9480 | Val Loss: 2.0467 | Val Acc: 0.4631 | Top-5: 0.7804 | F1: 0.4526

==== Epoch 44/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.51it/s]
Train Loss: 0.9417 | Val Loss: 2.0352 | Val Acc: 0.4738 | Top-5: 0.7858 | F1: 0.4622

==== Epoch 45/50 ====
Train: 100%|██████████| 256/256 [01:32<00:00,  2.77it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.45it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9450 | Val Loss: 2.0359 | Val Acc: 0.4743 | Top-5: 0.7848 | F1: 0.4645

==== Epoch 46/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:12<00:00,  5.30it/s]
Train Loss: 0.9405 | Val Loss: 2.0550 | Val Acc: 0.4733 | Top-5: 0.7819 | F1: 0.4619

==== Epoch 47/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:12<00:00,  5.23it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9284 | Val Loss: 2.0548 | Val Acc: 0.4724 | Top-5: 0.7780 | F1: 0.4632

==== Epoch 48/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.60it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9378 | Val Loss: 2.0431 | Val Acc: 0.4758 | Top-5: 0.7848 | F1: 0.4651

==== Epoch 49/50 ====
Train: 100%|██████████| 256/256 [01:30<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.73it/s]
Train:   0%|          | 0/256 [00:00<?, ?it/s]Train Loss: 0.9377 | Val Loss: 2.0580 | Val Acc: 0.4670 | Top-5: 0.7819 | F1: 0.4579

==== Epoch 50/50 ====
Train: 100%|██████████| 256/256 [01:31<00:00,  2.81it/s]
Val: 100%|██████████| 64/64 [00:11<00:00,  5.45it/s]
Train Loss: 0.9431 | Val Loss: 2.0340 | Val Acc: 0.4719 | Top-5: 0.7804 | F1: 0.4603
收敛到最优Val Loss Epoch: 19，总训练用时: 87.96 分钟
SpeedTest: 100%|██████████| 64/64 [00:12<00:00,  5.29it/s]
推理平均测试速度: 1.891 ms/图像
推理最大显存占用: 377.14 MB
Kaggle Test: 100%|██████████| 324/324 [02:08<00:00,  2.53it/s]
Kaggle提交文件保存至: D:\homework\Course_Design_of_artificial_intelligence\third\ResNet_Seblock\fangzhang_ResNet_kaggle_dalao\PhanDai_ResNet_seblock_kaggle_dalao\pre_test\newV2_pre\submission_se.csv

进程已结束,退出代码0