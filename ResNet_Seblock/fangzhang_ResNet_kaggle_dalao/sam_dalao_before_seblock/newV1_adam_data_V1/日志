lr  0.01

D:\ProgramData\anaconda3\envs\homework_2_1\python.exe D:/homework/Course_Design_of_artificial_intelligence/third/ResNet_Seblock/fangzhang_ResNet_kaggle_dalao/sam_dalao_before_seblock/newV1_data.py
Using device: cuda
数据增强：True | 训练：True | 测试：True
数据增强
------ 模型结构和参数量 ------
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1         [-1, 64, 112, 112]           9,408
       BatchNorm2d-2         [-1, 64, 112, 112]             128
              ReLU-3         [-1, 64, 112, 112]               0
         MaxPool2d-4           [-1, 64, 56, 56]               0
            Conv2d-5           [-1, 64, 56, 56]          36,864
       BatchNorm2d-6           [-1, 64, 56, 56]             128
              ReLU-7           [-1, 64, 56, 56]               0
            Conv2d-8           [-1, 64, 56, 56]          36,864
       BatchNorm2d-9           [-1, 64, 56, 56]             128
AdaptiveAvgPool2d-10             [-1, 64, 1, 1]               0
           Linear-11                    [-1, 4]             256
             ReLU-12                    [-1, 4]               0
           Linear-13                   [-1, 64]             256
          Sigmoid-14                   [-1, 64]               0
          SEBlock-15           [-1, 64, 56, 56]               0
             ReLU-16           [-1, 64, 56, 56]               0
     BasicBlockSE-17           [-1, 64, 56, 56]               0
           Conv2d-18           [-1, 64, 56, 56]          36,864
      BatchNorm2d-19           [-1, 64, 56, 56]             128
             ReLU-20           [-1, 64, 56, 56]               0
           Conv2d-21           [-1, 64, 56, 56]          36,864
      BatchNorm2d-22           [-1, 64, 56, 56]             128
AdaptiveAvgPool2d-23             [-1, 64, 1, 1]               0
           Linear-24                    [-1, 4]             256
             ReLU-25                    [-1, 4]               0
           Linear-26                   [-1, 64]             256
          Sigmoid-27                   [-1, 64]               0
          SEBlock-28           [-1, 64, 56, 56]               0
             ReLU-29           [-1, 64, 56, 56]               0
     BasicBlockSE-30           [-1, 64, 56, 56]               0
           Conv2d-31          [-1, 128, 28, 28]          73,728
      BatchNorm2d-32          [-1, 128, 28, 28]             256
             ReLU-33          [-1, 128, 28, 28]               0
           Conv2d-34          [-1, 128, 28, 28]         147,456
      BatchNorm2d-35          [-1, 128, 28, 28]             256
AdaptiveAvgPool2d-36            [-1, 128, 1, 1]               0
           Linear-37                    [-1, 8]           1,024
             ReLU-38                    [-1, 8]               0
           Linear-39                  [-1, 128]           1,024
          Sigmoid-40                  [-1, 128]               0
          SEBlock-41          [-1, 128, 28, 28]               0
           Conv2d-42          [-1, 128, 28, 28]           8,192
      BatchNorm2d-43          [-1, 128, 28, 28]             256
             ReLU-44          [-1, 128, 28, 28]               0
     BasicBlockSE-45          [-1, 128, 28, 28]               0
           Conv2d-46          [-1, 128, 28, 28]         147,456
      BatchNorm2d-47          [-1, 128, 28, 28]             256
             ReLU-48          [-1, 128, 28, 28]               0
           Conv2d-49          [-1, 128, 28, 28]         147,456
      BatchNorm2d-50          [-1, 128, 28, 28]             256
AdaptiveAvgPool2d-51            [-1, 128, 1, 1]               0
           Linear-52                    [-1, 8]           1,024
             ReLU-53                    [-1, 8]               0
           Linear-54                  [-1, 128]           1,024
          Sigmoid-55                  [-1, 128]               0
          SEBlock-56          [-1, 128, 28, 28]               0
             ReLU-57          [-1, 128, 28, 28]               0
     BasicBlockSE-58          [-1, 128, 28, 28]               0
           Conv2d-59          [-1, 256, 14, 14]         294,912
      BatchNorm2d-60          [-1, 256, 14, 14]             512
             ReLU-61          [-1, 256, 14, 14]               0
           Conv2d-62          [-1, 256, 14, 14]         589,824
      BatchNorm2d-63          [-1, 256, 14, 14]             512
AdaptiveAvgPool2d-64            [-1, 256, 1, 1]               0
           Linear-65                   [-1, 16]           4,096
             ReLU-66                   [-1, 16]               0
           Linear-67                  [-1, 256]           4,096
          Sigmoid-68                  [-1, 256]               0
          SEBlock-69          [-1, 256, 14, 14]               0
           Conv2d-70          [-1, 256, 14, 14]          32,768
      BatchNorm2d-71          [-1, 256, 14, 14]             512
             ReLU-72          [-1, 256, 14, 14]               0
     BasicBlockSE-73          [-1, 256, 14, 14]               0
           Conv2d-74          [-1, 256, 14, 14]         589,824
      BatchNorm2d-75          [-1, 256, 14, 14]             512
             ReLU-76          [-1, 256, 14, 14]               0
           Conv2d-77          [-1, 256, 14, 14]         589,824
      BatchNorm2d-78          [-1, 256, 14, 14]             512
AdaptiveAvgPool2d-79            [-1, 256, 1, 1]               0
           Linear-80                   [-1, 16]           4,096
             ReLU-81                   [-1, 16]               0
           Linear-82                  [-1, 256]           4,096
          Sigmoid-83                  [-1, 256]               0
          SEBlock-84          [-1, 256, 14, 14]               0
             ReLU-85          [-1, 256, 14, 14]               0
     BasicBlockSE-86          [-1, 256, 14, 14]               0
           Conv2d-87            [-1, 512, 7, 7]       1,179,648
      BatchNorm2d-88            [-1, 512, 7, 7]           1,024
             ReLU-89            [-1, 512, 7, 7]               0
           Conv2d-90            [-1, 512, 7, 7]       2,359,296
      BatchNorm2d-91            [-1, 512, 7, 7]           1,024
AdaptiveAvgPool2d-92            [-1, 512, 1, 1]               0
           Linear-93                   [-1, 32]          16,384
             ReLU-94                   [-1, 32]               0
           Linear-95                  [-1, 512]          16,384
          Sigmoid-96                  [-1, 512]               0
          SEBlock-97            [-1, 512, 7, 7]               0
           Conv2d-98            [-1, 512, 7, 7]         131,072
      BatchNorm2d-99            [-1, 512, 7, 7]           1,024
            ReLU-100            [-1, 512, 7, 7]               0
    BasicBlockSE-101            [-1, 512, 7, 7]               0
          Conv2d-102            [-1, 512, 7, 7]       2,359,296
     BatchNorm2d-103            [-1, 512, 7, 7]           1,024
            ReLU-104            [-1, 512, 7, 7]               0
          Conv2d-105            [-1, 512, 7, 7]       2,359,296
     BatchNorm2d-106            [-1, 512, 7, 7]           1,024
AdaptiveAvgPool2d-107            [-1, 512, 1, 1]               0
          Linear-108                   [-1, 32]          16,384
            ReLU-109                   [-1, 32]               0
          Linear-110                  [-1, 512]          16,384
         Sigmoid-111                  [-1, 512]               0
         SEBlock-112            [-1, 512, 7, 7]               0
            ReLU-113            [-1, 512, 7, 7]               0
    BasicBlockSE-114            [-1, 512, 7, 7]               0
AdaptiveAvgPool2d-115            [-1, 512, 1, 1]               0
          Linear-116                  [-1, 120]          61,560
================================================================
Total params: 11,325,112
Trainable params: 11,325,112
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.57
Forward/backward pass size (MB): 68.57
Params size (MB): 43.20
Estimated Total Size (MB): 112.35
----------------------------------------------------------------
参数量: 11.33M
模型大小: 43.24 MB
FLOPs: 3.65 GFLOPs/图像

==== Epoch 1/50 ====
Train: 100%|██████████| 128/128 [02:21<00:00,  1.11s/it]
Val: 100%|██████████| 32/32 [00:17<00:00,  1.86it/s]
Train Loss: 4.8472 | Val Loss: 4.7804 | Val Acc: 0.0137 | Top-5: 0.0567 | F1: 0.0007

==== Epoch 2/50 ====
Train: 100%|██████████| 128/128 [02:30<00:00,  1.18s/it]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.35it/s]
Train Loss: 4.7746 | Val Loss: 4.7574 | Val Acc: 0.0132 | Top-5: 0.0699 | F1: 0.0016

==== Epoch 3/50 ====
Train: 100%|██████████| 128/128 [02:18<00:00,  1.08s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.21it/s]
Train Loss: 4.7302 | Val Loss: 4.7168 | Val Acc: 0.0166 | Top-5: 0.0753 | F1: 0.0021
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 4/50 ====
Train: 100%|██████████| 128/128 [02:13<00:00,  1.04s/it]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.37it/s]
Train Loss: 4.6991 | Val Loss: 4.6773 | Val Acc: 0.0171 | Top-5: 0.0817 | F1: 0.0038
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 5/50 ====
Train: 100%|██████████| 128/128 [02:08<00:00,  1.00s/it]
Val: 100%|██████████| 32/32 [00:12<00:00,  2.47it/s]
Train Loss: 4.6311 | Val Loss: 4.6404 | Val Acc: 0.0220 | Top-5: 0.1027 | F1: 0.0051

==== Epoch 6/50 ====
Train: 100%|██████████| 128/128 [02:08<00:00,  1.00s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.19it/s]
Train Loss: 4.5529 | Val Loss: 4.5088 | Val Acc: 0.0401 | Top-5: 0.1408 | F1: 0.0131

==== Epoch 7/50 ====
Train: 100%|██████████| 128/128 [02:16<00:00,  1.06s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.16it/s]
Train Loss: 4.4350 | Val Loss: 4.4218 | Val Acc: 0.0460 | Top-5: 0.1467 | F1: 0.0172

==== Epoch 8/50 ====
Train: 100%|██████████| 128/128 [02:13<00:00,  1.04s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.26it/s]
Train Loss: 4.2874 | Val Loss: 4.2714 | Val Acc: 0.0518 | Top-5: 0.2010 | F1: 0.0245

==== Epoch 9/50 ====
Train: 100%|██████████| 128/128 [02:12<00:00,  1.04s/it]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.46it/s]
Train Loss: 4.2307 | Val Loss: 4.2470 | Val Acc: 0.0606 | Top-5: 0.2044 | F1: 0.0300
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 10/50 ====
Train: 100%|██████████| 128/128 [02:05<00:00,  1.02it/s]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.38it/s]
Train:   0%|          | 0/128 [00:00<?, ?it/s]Train Loss: 4.1947 | Val Loss: 4.2550 | Val Acc: 0.0567 | Top-5: 0.2083 | F1: 0.0269

==== Epoch 11/50 ====
Train: 100%|██████████| 128/128 [02:07<00:00,  1.00it/s]
Val: 100%|██████████| 32/32 [00:12<00:00,  2.46it/s]
Train Loss: 4.1641 | Val Loss: 4.2010 | Val Acc: 0.0675 | Top-5: 0.2230 | F1: 0.0337
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 12/50 ====
Train: 100%|██████████| 128/128 [02:06<00:00,  1.01it/s]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.38it/s]
Train Loss: 4.1252 | Val Loss: 4.1753 | Val Acc: 0.0694 | Top-5: 0.2342 | F1: 0.0374
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 13/50 ====
Train: 100%|██████████| 128/128 [02:07<00:00,  1.01it/s]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.43it/s]
Train Loss: 4.0914 | Val Loss: 4.1561 | Val Acc: 0.0753 | Top-5: 0.2386 | F1: 0.0430
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 14/50 ====
Train: 100%|██████████| 128/128 [02:03<00:00,  1.04it/s]
Val: 100%|██████████| 32/32 [00:12<00:00,  2.47it/s]
Train Loss: 4.0486 | Val Loss: 4.1212 | Val Acc: 0.0831 | Top-5: 0.2460 | F1: 0.0540
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 15/50 ====
Train: 100%|██████████| 128/128 [02:06<00:00,  1.01it/s]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.29it/s]
Train Loss: 3.9979 | Val Loss: 4.0965 | Val Acc: 0.0846 | Top-5: 0.2562 | F1: 0.0550
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 16/50 ====
Train: 100%|██████████| 128/128 [02:12<00:00,  1.03s/it]
Val: 100%|██████████| 32/32 [00:13<00:00,  2.32it/s]
Train Loss: 3.9759 | Val Loss: 4.0919 | Val Acc: 0.0861 | Top-5: 0.2601 | F1: 0.0536
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 17/50 ====
Train: 100%|██████████| 128/128 [02:12<00:00,  1.03s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.18it/s]
Train Loss: 3.9718 | Val Loss: 4.0831 | Val Acc: 0.0841 | Top-5: 0.2587 | F1: 0.0536

==== Epoch 18/50 ====
Train: 100%|██████████| 128/128 [02:22<00:00,  1.11s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.20it/s]
Train Loss: 3.9517 | Val Loss: 4.0728 | Val Acc: 0.0826 | Top-5: 0.2631 | F1: 0.0527
Train:   0%|          | 0/128 [00:00<?, ?it/s]
==== Epoch 19/50 ====
Train: 100%|██████████| 128/128 [02:15<00:00,  1.06s/it]
Val: 100%|██████████| 32/32 [00:14<00:00,  2.19it/s]
Train Loss: 3.9464 | Val Loss: 4.0719 | Val Acc: 0.0831 | Top-5: 0.2621 | F1: 0.0533

==== Epoch 20/50 ====
Train: 100%|██████████| 128/128 [02:14<00:00,  1.05s/it]
Val: 100%|██████████| 32/32 [00:15<00:00,  2.08it/s]
Train:   0%|          | 0/128 [00:00<?, ?it/s]Train Loss: 3.9326 | Val Loss: 4.0737 | Val Acc: 0.0826 | Top-5: 0.2636 | F1: 0.0542

==== Epoch 21/50 ====
